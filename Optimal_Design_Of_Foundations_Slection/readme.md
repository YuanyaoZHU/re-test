This code is programed by Jiahao Chen, which is used for optimization of platform foundation type.